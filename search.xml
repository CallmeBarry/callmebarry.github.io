<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title><![CDATA[page你好]]></title>
      <url>/2017/08/17/%E5%BE%AE%E4%BF%A1%E5%88%86%E4%BA%AB/</url>
      <content type="html"><![CDATA[<blockquote>
<p>###发现网上好多教程都是不行的，我钻研了一晚上，终于搞定。官方都没有那么详细，所以我就分享一下，微信静态页面的分享，转发。</p>
</blockquote>
<p>####首先我们先上效果图，本次效果是这样的</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5842186-16a0313776ce9355.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="微信分享"></p>
<p>一般我们的网站转发是这样的</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5842186-67eabb0201c3dd7d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Paste_Image.png"></p>
<blockquote>
<p>废话不说，开始演示：<br>（1）要和微信公众号关联<br>步骤一：绑定域名<br>先登录微信公众平台进入“公众号设置”的“功能设置”里填写“JS接口安全域名”。<br>备注：登录后可在“开发者中心”查看对应的接口权限。</p>
</blockquote>
<p><img src="http://upload-images.jianshu.io/upload_images/5842186-978c17e89f7696d5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Paste_Image.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/5842186-cc656d143823a40b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Paste_Image.png"></p>
<p>步骤二：引入JS文件<br>在需要调用JS接口的页面引入如下JS文件，（支持https）：<a href="http://res.wx.qq.com/open/js/jweixin-1.2.0.js" target="_blank" rel="external">http://res.wx.qq.com/open/js/jweixin-1.2.0.js</a></p>
<p>ps：这里有官方的示例代码（<a href="http://demo.open.weixin.qq.com/jssdk/sample.zip" target="_blank" rel="external">http://demo.open.weixin.qq.com/jssdk/sample.zip</a>）。可以看看，有java，php，python，node各种版本，为什么需要这些呢，因为你需要动态获取这些参数</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5842186-ade98b4284dd71ae.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Paste_Image.png"><br>这些就在后台生成。</p>
<p>本次我就以php作为后台，ps：本人java，不会php，我知道用java搭后台比较麻烦，所以用php比较快捷<br>在文件目录写一个”jssdk.php”文件，需要改2个位置AppID和AppSecret</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div></pre></td><td class="code"><pre><div class="line">&lt;?php    </div><div class="line">$url = $_GET['url'];    </div><div class="line">class JSSDK &#123;    </div><div class="line">  private $appId;    </div><div class="line">  private $appSecret;    </div><div class="line">  private $url;    </div><div class="line">  public function __construct($appId, $appSecret,$url) &#123;    </div><div class="line">    $this-&gt;appId = $appId;    </div><div class="line">    $this-&gt;appSecret = $appSecret;    </div><div class="line">$this-&gt;url = $url;    </div><div class="line">  &#125;    </div><div class="line">    </div><div class="line">    </div><div class="line">  public function getSignPackage() &#123;    </div><div class="line">    $jsapiTicket = $this-&gt;getJsApiTicket();    </div><div class="line">    $protocol = (!empty($_SERVER['HTTPS']) &amp;&amp; $_SERVER['HTTPS'] !== 'off' || $_SERVER['SERVER_PORT'] == 443) ? "https://" : "http://";    </div><div class="line">   // $url = "$protocol$_SERVER[HTTP_HOST]$_SERVER[REQUEST_URI]";    </div><div class="line">$url =$this-&gt;url;    </div><div class="line">    $timestamp = time();    </div><div class="line">    $nonceStr = $this-&gt;createNonceStr();    </div><div class="line">    </div><div class="line">    </div><div class="line">    // 这里参数的顺序要按照 key 值 ASCII 码升序排序    </div><div class="line">    $string = "jsapi_ticket=$jsapiTicket&amp;noncestr=$nonceStr&amp;timestamp=$timestamp&amp;url=$url";  //这里经常出问题,一般都是这里出现问题，要留意  </div><div class="line">    </div><div class="line">    </div><div class="line">    $signature = sha1($string);    </div><div class="line">    </div><div class="line">    $signPackage = array(    </div><div class="line">      "appId"     =&gt; $this-&gt;appId,    </div><div class="line">      "nonceStr"  =&gt; $nonceStr,    </div><div class="line">      "timestamp" =&gt; $timestamp,    </div><div class="line">      "url"       =&gt; $url,    </div><div class="line">      "signature" =&gt; $signature,    </div><div class="line">      "rawString" =&gt; $string    </div><div class="line">    );    </div><div class="line">    return $signPackage;     </div><div class="line">  &#125;    </div><div class="line">    </div><div class="line">    </div><div class="line">  private function createNonceStr($length = 16) &#123;    </div><div class="line">    $chars = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";    </div><div class="line">    $str = "";    </div><div class="line">    for ($i = 0; $i &lt; $length; $i++) &#123;    </div><div class="line">      $str .= substr($chars, mt_rand(0, strlen($chars) - 1), 1);    </div><div class="line">    &#125;    </div><div class="line">    return $str;    </div><div class="line">  &#125;    </div><div class="line">        </div><div class="line">  private function getJsApiTicket() &#123;    </div><div class="line">    // jsapi_ticket 应该全局存储与更新，以下代码以写入到文件中做示例    </div><div class="line">    $data = json_decode(file_get_contents("jsapi_ticket.json"));    </div><div class="line">    if ($data-&gt;expire_time &lt; time()) &#123;    </div><div class="line">      $accessToken = $this-&gt;getAccessToken();    </div><div class="line">      // 如果是企业号用以下 URL 获取 ticket    </div><div class="line">      // $url = "https://qyapi.weixin.qq.com/cgi-bin/get_jsapi_ticket?access_token=$accessToken";    </div><div class="line">      $url = "https://api.weixin.qq.com/cgi-bin/ticket/getticket?type=jsapi&amp;access_token=$accessToken";    </div><div class="line">      $res = json_decode($this-&gt;httpGet($url));    </div><div class="line">      $ticket = $res-&gt;ticket;    </div><div class="line">      if ($ticket) &#123;    </div><div class="line">        $data-&gt;expire_time = time() + 7000;    </div><div class="line">        $data-&gt;jsapi_ticket = $ticket;    </div><div class="line">        $fp = fopen("jsapi_ticket.json", "w");    </div><div class="line">        fwrite($fp, json_encode($data));    </div><div class="line">        fclose($fp);    </div><div class="line">      &#125;    </div><div class="line">    &#125; else &#123;    </div><div class="line">      $ticket = $data-&gt;jsapi_ticket;    </div><div class="line">    &#125;    </div><div class="line">    </div><div class="line">    </div><div class="line">    return $ticket;    </div><div class="line">  &#125;    </div><div class="line">    </div><div class="line">    </div><div class="line">  private function getAccessToken() &#123;    </div><div class="line">    // access_token 应该全局存储与更新，以下代码以写入到文件中做示例    </div><div class="line">    $data = json_decode(file_get_contents("access_token.json"));    </div><div class="line">    if ($data-&gt;expire_time &lt; time()) &#123;    </div><div class="line">      // 如果是企业号用以下URL获取access_token    </div><div class="line">      // $url = "https://qyapi.weixin.qq.com/cgi-bin/gettoken?corpid=$this-&gt;appId&amp;corpsecret=$this-&gt;appSecret";    </div><div class="line">      $url = "https://api.weixin.qq.com/cgi-bin/token?grant_type=client_credential&amp;appid=$this-&gt;appId&amp;secret=$this-&gt;appSecret";    </div><div class="line">      $res = json_decode($this-&gt;httpGet($url));    </div><div class="line">      $access_token = $res-&gt;access_token;    </div><div class="line">      if ($access_token) &#123;    </div><div class="line">        $data-&gt;expire_time = time() + 7000;    </div><div class="line">        $data-&gt;access_token = $access_token;    </div><div class="line">        $fp = fopen("access_token.json", "w");    </div><div class="line">        fwrite($fp, json_encode($data));    </div><div class="line">        fclose($fp);    </div><div class="line">      &#125;    </div><div class="line">    &#125; else &#123;    </div><div class="line">      $access_token = $data-&gt;access_token;    </div><div class="line">    &#125;    </div><div class="line">    return $access_token;    </div><div class="line">  &#125;    </div><div class="line">    </div><div class="line">  private function httpGet($url) &#123;    </div><div class="line">    $curl = curl_init();    </div><div class="line">    curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);    </div><div class="line">    curl_setopt($curl, CURLOPT_TIMEOUT, 500);    </div><div class="line">    curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, false);    </div><div class="line">    curl_setopt($curl, CURLOPT_SSL_VERIFYHOST, false);    </div><div class="line">    curl_setopt($curl, CURLOPT_URL, $url);    </div><div class="line">    $res = curl_exec($curl);    </div><div class="line">    curl_close($curl);    </div><div class="line">    return $res;    </div><div class="line">  &#125;    </div><div class="line">&#125;    </div><div class="line">    </div><div class="line">$jssdk = new JSSDK("公众号AppID", "公众号AppSecret",$url);//按照自己的公众号填写    </div><div class="line">$signPackage = $jssdk-&gt;GetSignPackage();    </div><div class="line">// var_dump($signPackage);  </div><div class="line">$tmp=json_encode(array ('appId'=&gt;$signPackage["appId"],'timestamp'=&gt;$signPackage["timestamp"],'nonceStr'=&gt;$signPackage["nonceStr"],'signature'=&gt;$signPackage["signature"],'url'=&gt;$signPackage["url"]));    </div><div class="line">$callback = $_GET['callback'];    </div><div class="line">echo $callback.'('.$tmp.')';    </div><div class="line">exit;    </div><div class="line">?&gt;</div></pre></td></tr></table></figure>
<p>在”html”就如下:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">head</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=640, target-densitydpi=device-dpi, user-scalable=no"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"keywords"</span> <span class="attr">content</span>=<span class="string">"测试"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"jquery.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"http://res.wx.qq.com/open/js/jweixin-1.0.0.js"</span>&gt;</span><span class="undefined"></span></div><div class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></div><div class="line">        url = location.href.split('#')[0];  </div><div class="line">        url = encodeURIComponent(url); </div><div class="line">        $.ajax(&#123;</div><div class="line">            type: "get",</div><div class="line">            url: "http://xxxxxx/jssdk.php?url=" + url,</div><div class="line">            //替换网址，xxxxx根据自己jssdk.php文件位置修改</div><div class="line">            dataType: "jsonp",</div><div class="line">            jsonp: "callback",</div><div class="line">            jsonpCallback: "success_jsonpCallback",</div><div class="line">            success: function(data) &#123;</div><div class="line">                wx.config(&#123;</div><div class="line">                    appId: data.appId,</div><div class="line">                    timestamp: data.timestamp,</div><div class="line">                    nonceStr: data.nonceStr,</div><div class="line">                    signature: data.signature,</div><div class="line">                    jsApiList: [</div><div class="line">			"onMenuShareTimeline", //分享给好友</div><div class="line">                        "onMenuShareAppMessage", //分享到朋友圈</div><div class="line">                        "onMenuShareQQ", //分享到QQ</div><div class="line">                        "onMenuShareWeibo" //分享到微博</div><div class="line">                    ]</div><div class="line">                &#125;);</div><div class="line">            &#125;,</div><div class="line">            error: function(data) &#123;</div><div class="line">                alert("连接失败！");</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">        wx.ready(function() &#123;</div><div class="line">            var shareData = &#123;</div><div class="line">                title: '老王标题',</div><div class="line">                desc: '老王不想写简介',</div><div class="line">                //这里请特别注意是要去除html</div><div class="line">                link: 'http://wwl0660.club',</div><div class="line">                imgUrl: 'wwl0660.club/logo.jpg'</div><div class="line">            &#125;;</div><div class="line">            wx.onMenuShareAppMessage(shareData);</div><div class="line">            wx.onMenuShareTimeline(shareData);</div><div class="line">            wx.onMenuShareQQ(shareData);</div><div class="line">            wx.onMenuShareWeibo(shareData);</div><div class="line">        &#125;);</div><div class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>老王的测试<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">![](logo.jpg)</div><div class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>123微信测试<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<p>当然运行php要有php的服务器，我用的就是“phpstudy”，简单，作为程序员，自己去摸索，简单</p>
]]></content>
      
        <categories>
            
            <category> 微信 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 微信 </tag>
            
            <tag> 转发 </tag>
            
            <tag> php，分享，缩略图，简介 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[利用github搭建hexo博客]]></title>
      <url>/2017/07/15/%E7%AC%AC%E4%B8%80%E6%AC%A1/</url>
      <content type="html"><![CDATA[<p>第一次在github上建博客站，感觉一切都太神奇了，原来还可以这么玩，然后自己又百度了一番，原来不止hexo,还有jekyll等等，这些大体都是通过本地修改写博客，生成静态页面，然后上传上服务器主机，达到博客的样子，不需要数据库之类的<a id="more"></a></p>
<h2 id="总结一下"><a href="#总结一下" class="headerlink" title="总结一下"></a>总结一下</h2><h2 id="此次用的是hexo-github搭建的本博客网站，hexo有许多样式主题，改个配置就能更换一套主题，so-easy-下面我就说一下我的建站过程遇到的一些问题"><a href="#此次用的是hexo-github搭建的本博客网站，hexo有许多样式主题，改个配置就能更换一套主题，so-easy-下面我就说一下我的建站过程遇到的一些问题" class="headerlink" title="此次用的是hexo+github搭建的本博客网站，hexo有许多样式主题，改个配置就能更换一套主题，so easy 下面我就说一下我的建站过程遇到的一些问题"></a>此次用的是hexo+github搭建的本博客网站，hexo有许多样式主题，改个配置就能更换一套主题，so easy 下面我就说一下我的建站过程遇到的一些问题</h2><ul>
<li>一切命令在这运行<img src="https://github.com/callmebarry/callmebarry.github.io/blob/master/img/20170719_1.PNG" alt="img">，不用dos命令窗口。</li>
<li>CNAME文件你可以在github上创建，或者在生成的文件public目录下创建</li>
<li>给一个比较详细的<a href="http://www.lovebxm.com/2017/05/30/buildBlog/" target="_blank" rel="external">搭建hexo博客</a>的地址，希望能帮到你们</li>
</ul>
]]></content>
      
        <categories>
            
            <category> hexo </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 博客 </tag>
            
            <tag> 技术 </tag>
            
            <tag> git </tag>
            
        </tags>
        
    </entry>
    
  
  
</search>
